<!DOCTYPE html>
<html lang="en">
<head>
    <title>Exhibit B: Floating Gallery</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    
    <!-- CRITICAL FIX: Use the 'main' branch for CSS so the 'Enter AR' button appears -->
    <link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/gh/google/xrblocks@main/samples/main.css" />

    <style>
        /* Optional: Custom styling for your info text */
        #info {
            position: absolute;
            top: 20px;
            width: 100%;
            text-align: center;
            color: white;
            pointer-events: none;
            z-index: 999;
            font-family: sans-serif;
            text-shadow: 1px 1px 2px black;
        }
    </style>
    
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.182.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.182.0/examples/jsm/",
            "xrblocks": "https://cdn.jsdelivr.net/gh/google/xrblocks@build/xrblocks.js",
            "xrblocks/addons/": "https://cdn.jsdelivr.net/gh/google/xrblocks@build/addons/"
        }
    }
    </script>
</head>
<body>

    <div id="info">
        <h3>Floating Gallery</h3>
        <p>Press "Enter AR" below to view in your room</p>
    </div>

    <script type="module">
        import * as THREE from 'three';
        import * as xb from 'xrblocks';

        class GalleryScene extends xb.Script {
            
            async init() {
                // 1. Add Lights
                const light = new THREE.DirectionalLight(0xffffff, 3);
                light.position.set(0, 5, 5);
                this.add(light);
                this.add(new THREE.AmbientLight(0xffffff, 1));

                // 2. Create Background (Blue Sphere)
                // We keep a reference to this so we can hide it in AR
                const bgGeo = new THREE.SphereGeometry(10, 32, 32);
                const bgMat = new THREE.MeshBasicMaterial({ 
                    color: 0x224488, 
                    side: THREE.BackSide 
                });
                this.bgSphere = new THREE.Mesh(bgGeo, bgMat);
                this.add(this.bgSphere);

                // 3. Create Art Panels
                this.createArt();
            }

            createArt() {
                // Using generated placeholder images to guarantee they load
                const imageUrls = [
                    'https://placehold.co/600x800/orange/white.png?text=Art+1',
                    'https://placehold.co/600x800/purple/white.png?text=Art+2'
                ];

                this.panels = [];
                const loader = new THREE.TextureLoader();

                imageUrls.for